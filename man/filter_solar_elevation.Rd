% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/insol_functions.R
\name{filter_solar_elevation}
\alias{filter_solar_elevation}
\title{Filter times by solar elevation angle}
\usage{
filter_solar_elevation(time, lat, lon, min_elevation = 10)
}
\arguments{
\item{time}{Timestamps as POSIXct, POSIXlt, character, or numeric. If a timezone
is specified, times are internally converted to UTC for solar position
calculations. If no timezone is specified, UTC is assumed. See
\code{\link{time_utils}} for details.}

\item{lat}{Latitude in degrees (negative for southern hemisphere)}

\item{lon}{Longitude in degrees (east positive, west negative)}

\item{min_elevation}{Minimum solar elevation angle in degrees.
Times with elevation angles below this value will return FALSE.
Default: 10 degrees (filters out times when sun is very low on horizon)}
}
\value{
Logical vector of the same length as time, where TRUE indicates
the solar elevation angle is greater than or equal to min_elevation.
}
\description{
Create a logical filter vector indicating times when the solar elevation angle
meets or exceeds a specified threshold. This is useful for filtering out times when
the sun is too low on the horizon, such as during early morning, late evening,
twilight, or nighttime conditions.

The function calculates solar position using the same algorithms as the
clear-sky models, ensuring consistency with the rest of the package. All
time handling follows the package's timezone conventions, with input times
converted to UTC for solar position calculations.
}
\details{
Solar elevation angle is the height of the sun above the horizon, ranging from
0° (sun on the horizon) to 90° (sun directly overhead). Times with elevation
below the threshold will return FALSE.

Common values for \code{min_elevation}:
\itemize{
\item 0°: Any time the sun is above the horizon (all daylight hours)
\item 10°: Full daylight, minimal atmospheric effects (default)
\item 15°: Good for most PV applications
\item 20°: Avoiding low-angle irradiance and atmospheric effects
\item 30°: High sun only, for optimal PV performance
}

This function uses the solar position calculations from the insol package
(GPL-2 licensed) that are included in pvflux for solar position computations.
}
\examples{
\dontrun{
# Create sample data for a full day in South Africa
time <- seq(as.POSIXct("2026-01-15 00:00", tz = "Africa/Johannesburg"),
            by = "hour", length.out = 24)
lat <- -30.6279  # De Aar, South Africa
lon <- 24.0054

# Filter for daytime only (sun above horizon)
is_daytime <- filter_solar_elevation(time, lat, lon, min_elevation = 0)
daytime_hours <- time[is_daytime]
print(daytime_hours)

# Filter out low sun angles (keep only when sun is above 10 degrees)
is_high_sun <- filter_solar_elevation(time, lat, lon, min_elevation = 10)

# Filter out early morning and late evening (sun above 15 degrees)
is_good_quality <- filter_solar_elevation(time, lat, lon, min_elevation = 15)

# Apply filter to measurement data
# ghi_data <- data.frame(time = time, GHI = measured_ghi)
# filtered_data <- ghi_data[is_high_sun, ]

# Use with clear-sky pipeline for only high-elevation periods
result <- pv_clearsky_dc_pipeline(
  time = time[is_high_sun],
  lat = lat,
  lon = lon,
  T_air = rep(25, sum(is_high_sun)),
  wind = rep(3, sum(is_high_sun)),
  tilt = 30,
  azimuth = 0
)
}

}
