% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/lookup_linke_turbidity.R
\name{lookup_linke_turbidity}
\alias{lookup_linke_turbidity}
\title{Lookup Linke Turbidity from Climatological Database}
\usage{
lookup_linke_turbidity(
  time,
  lat,
  lon,
  interp_turbidity = TRUE,
  filepath = NULL
)
}
\arguments{
\item{time}{Timestamps as POSIXct, POSIXlt, character, or numeric. Used to
extract month for selecting appropriate turbidity values.}

\item{lat}{Latitude in decimal degrees (-90 to 90). Can be a single value
or vector matching length of time.}

\item{lon}{Longitude in decimal degrees (-180 to 180). Can be a single value
or vector matching length of time.}

\item{interp_turbidity}{Logical. If TRUE, interpolates monthly values to
daily resolution using the day of year. If FALSE, returns the value for
the month containing each timestamp. Default: TRUE}

\item{filepath}{Optional path to LinkeTurbidities.h5 file. If NULL (default),
uses the file distributed with the package.}
}
\value{
Numeric vector of Linke turbidity values (dimensionless) matching
the length of time.
}
\description{
Retrieve monthly climatological Linke turbidity values from the global
database distributed with pvlib-python. The database provides turbidity
values at 5 arcminute resolution (0.0833°) for any location worldwide.

The Linke turbidity coefficient quantifies the atmospheric turbidity
(aerosols and water vapor) relative to a clean, dry atmosphere. Typical
values range from 2 (very clean) to 6+ (very polluted/humid).
}
\details{
The database contains monthly climatological values on a global 5 arcminute
grid (2160 × 4320 × 12 matrix). Values are interpolated from the nearest
grid point.

\strong{Data Source}: SoDa (Solar radiation Data) service, based on the worldwide
Linke turbidity database by Remund et al. (2003).

\strong{Grid Details}:
\itemize{
\item Latitude: 90°N to 90°S (2160 points, 5 arcminute spacing)
\item Longitude: -180° to 180° (4320 points, 5 arcminute spacing)
\item Time: Monthly climatology (12 values per location)
}

\strong{Interpolation}: When \code{interp_turbidity = TRUE}, monthly values are
interpolated to daily resolution using a sinusoidal fit through month
midpoints. This provides smooth daily variations.
}
\examples{
\dontrun{
# Single location, multiple times
time <- seq(as.POSIXct("2026-01-01", tz = "UTC"),
            by = "month", length.out = 12)
tl <- lookup_linke_turbidity(time, lat = -30.6279, lon = 24.0054)

# Multiple locations
time <- rep(as.POSIXct("2026-06-15", tz = "UTC"), 3)
lat <- c(-30.6, 40.7, 51.5)  # De Aar, New York, London
lon <- c(24.0, -74.0, -0.1)
tl <- lookup_linke_turbidity(time, lat, lon)

# Without daily interpolation (monthly values only)
tl_monthly <- lookup_linke_turbidity(time, lat, lon, interp_turbidity = FALSE)
}

}
\references{
Remund, J., Wald, L., Lefèvre, M., Ranchin, T., & Page, J. (2003).
Worldwide Linke turbidity information. Proceedings of the ISES Solar
World Congress, Göteborg, Sweden.
}
